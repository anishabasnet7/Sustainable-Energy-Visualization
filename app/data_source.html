<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sustainable Energy — Data Explorer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
  <style> 
    body { background: #f7f9fc; color: #333; }
    .card { border: none; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 2rem; }
    .card-header { background: white; border-bottom: 1px solid #eee; font-weight: bold; color: #4f46e5; }
    .badge-custom { background-color: #e0e7ff; color: #4338ca; margin-right: 5px; }
    #loading-spinner { display: flex; justify-content: center; align-items: center; height: 200px; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
      <a class="navbar-brand" href="#">Global Data on Sustainable Energy (2000-2020)</a>
      <div class="d-flex">
        <a href="index.html" class="btn btn-outline-light btn-sm">← Back to Dashboard</a>
      </div>
    </div>
  </nav>

  <div class="container">
    
    <!-- About Dataset -->
    <div class="row">
      <div class="col-lg-12">
        <div class="card p-4">
          <h1 class="h2 mb-3">Global Data on Sustainable Energy</h1>
          <p class="text-muted">
           This dataset is about the sustainable energy indicators and other factor from different countries from 2000 to 2020. There are aspects like
           electricity access and so on.
          </p>
          
          <div class="mb-3">
            <strong>Tags:</strong>
            <span class="badge rounded-pill badge-custom">Energy</span>
            <span class="badge rounded-pill badge-custom">Sustainability</span>
          </div>
          
          <div class="d-flex gap-4 text-sm text-secondary">
            <span><strong>License:</strong> CC BY 4.0</span>
            <span><strong>Update Frequency:</strong> Annually</span>
            <span><strong>Rows:</strong> ~3,600</span>
            <span><strong>Columns:</strong> 21</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Data Dictionary -->
    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-header">
            Dataset Columns & Definitions
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-striped table-hover mb-0" style="font-size: 0.95rem;">
                <thead class="table-light">
                  <tr>
                    <th style="width: 30%">Column Name</th>
                    <th>Key Features (Source: <a href="https://www.kaggle.com/datasets/anshtanwar/global-data-on-sustainable-energy" target="_blank" style="text-decoration: underline;">Kaggle</a>)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td>Entity</td><td>The name of the country or region.</td></tr>
                  <tr><td>Year</td><td>The year of data report (2000 - 2020).</td></tr>
                  <tr><td>Access to electricity (% of population)</td><td>Percentage of population with access to electricity.</td></tr>
                  <tr><td>Access to clean fuels for cooking</td><td>Percentage of population with primary reliance on clean fuels.</td></tr>
                  <tr><td>Renewable-electricity-generating-capacity-per-capita</td><td>Installed Renewable energy capacity per person (Watts).</td></tr>
                  <tr><td>Financial flows to developing countries (US $)</td><td>Aid and assistance from developed countries for clean energy projects.</td></tr>
                  <tr><td>Renewable energy share in total final energy consumption (%)</td><td>Percentage of renewable energy in final energy consumption.</td></tr>
                  <tr><td>Electricity from fossil fuels (TWh)</td><td>Electricity generated from fossil fuels (coal, oil, gas).</td></tr>
                  <tr><td>Electricity from nuclear (TWh)</td><td>Electricity generated from nuclear power.</td></tr>
                  <tr><td>Electricity from renewables (TWh)</td><td>Electricity generated from renewable sources.</td></tr>
                  <tr><td>Low-carbon electricity (% electricity)</td><td>Percentage of electricity from low-carbon sources (nuclear + renewables).</td></tr>
                  <tr><td>Primary energy consumption per capita (kWh/person)</td><td>Energy consumption per person.</td></tr>
                  <tr><td>Energy intensity level of primary energy (MJ/$2011 PPP GDP)</td><td>Energy use per unit of GDP.</td></tr>
                  <tr><td>Value_co2_emissions (metric tons per capita)</td><td>Carbon dioxide emissions per person.</td></tr>
                  <tr><td>GDP growth (annual %)</td><td>Annual GDP growth rate.</td></tr>
                  <tr><td>GDP per capita</td><td>Gross domestic product per person.</td></tr>
                  <tr><td>Density (P/Km2)</td><td>Population density per square kilometer.</td></tr>
                  <tr><td>Land Area (Km2)</td><td>Total land area.</td></tr>
                  <tr><td>Latitude / Longitude</td><td>Geographic coordinates of the country centroid.</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--Live Data like Kaggle -->
    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <span>Data Preview</span>
            <button class="btn btn-sm btn-primary" onclick="loadData()">Reload</button>
          </div>
          <div class="card-body">
            
            <div id="loading-spinner">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
            </div>

            <div class="table-responsive" id="table-container" style="display:none;">
              <table id="main-table" class="table table-bordered table-sm w-100">
                <thead>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <script>
    const CSV_PATH = '../../data/processed_data.csv'; 

    $(document).ready(function() {
        loadData();
    });

    function loadData() {
        $('#loading-spinner').show();
        $('#table-container').hide();

        d3.csv(CSV_PATH).then(data => {
            if (data.length === 0) {
                alert("CSV file is empty or could not be loaded.");
                return;
            }

            //Headers Dynamically
            const columns = Object.keys(data[0]);
            const thead = d3.select('#main-table thead');
            thead.selectAll('*').remove();
            
            const headerRow = thead.append('tr');
            columns.forEach(col => {
                headerRow.append('th').text(col);
            });

            //Initialize DataTable
            if ($.fn.DataTable.isDataTable('#main-table')) {
                $('#main-table').DataTable().destroy();
                d3.select('#main-table tbody').selectAll('*').remove();
            }

            //D3 to create rows, then DataTable take over
            const tbody = d3.select('#main-table tbody');
            data.forEach(row => {
                const tr = tbody.append('tr');
                columns.forEach(col => {
                    tr.append('td').text(row[col]);
                });
            });

            //activate features (Pagination, Search, Sort)
            $('#main-table').DataTable({
                pageLength: 10,
                scrollX: true,
                language: {
                    search: "Filter records:"
                }
            });

            $('#loading-spinner').hide();
            $('#table-container').fadeIn();

        }).catch(error => {
            console.error(error);
            $('#loading-spinner').html('<p class="text-danger">Error loading data. Check console for details.<br>Make sure <code>' + CSV_PATH + '</code> exists.</p>');
        });
    }
  </script>
</body>
</html>